<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Progreso - Tecnicatura Analista de Sistemas</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>Progreso acadÃ©mico - Tecnicatura en AnÃ¡lisis de Sistemas / DiseÃ±ado por <a href="https://github.com/carlosguariglia" target="_blank" rel="noopener">Carlos Guariglia</a></h1>
      <p class="subtitle">Instituto Superior de Formacion Tecnica Nro 151</p>
    </header>

    <main>
      <section class="visual">
        <div class="mountain" id="mountain">
          <!-- Inline SVG mountain with trail path (id=trail) and climber group (id=climberG) -->
          <svg id="mountainSVG" class="mountain-svg" viewBox="0 0 600 800" preserveAspectRatio="xMidYMax meet" aria-hidden="true">
            <defs>
              <linearGradient id="g1" x1="0" x2="0" y1="0" y2="1">
                <stop offset="0%" stop-color="#9bd3ff"/>
                <stop offset="100%" stop-color="#e6f7ff"/>
              </linearGradient>
            </defs>
            <rect width="100%" height="100%" fill="url(#g1)" />

            <!-- Background mountain image provided by user (place assets/mountain.png) -->
            <image id="bgMountain" href="assets/montana.png" x="0" y="0" width="600" height="800" preserveAspectRatio="xMidYMid slice" />

            <!-- Optional vector fallback/shapes retained for smaller devices (removed fill/shape so background image is fully visible) -->
            <rect x="0" y="730" width="100%" height="70" fill="#cfe6ff"/>

            <!-- trail (used to place climber). Zig-zag mountain path with rounded curves; ends at the peak -->
            <path id="trail" d="M120 700
              C160 620, 140 580, 200 540
              C240 520, 220 480, 260 440
              C300 400, 280 360, 320 320
              C360 280, 340 240, 300 200
              C320 140, 310 130, 300 120" 
              fill="none" stroke="#ffffff" stroke-opacity="0.18" stroke-width="4" stroke-dasharray="10 8" stroke-linecap="round" stroke-linejoin="round" />

            <!-- climber group: now uses a raster image provided by the user (place assets/climber.png) -->
            <g id="climberG" class="climber-g" transform="translate(120,700)" aria-hidden="false">
              <!-- Image anchored with its feet roughly at y=0 of the group. Tune width/height/x/y as needed -->
              <image id="climberImg" href="assets/estudiante.png" x="-28" y="-72" width="56" height="72" preserveAspectRatio="xMidYMax" />
            </g>
          </svg>
          <div id="milestones" class="milestones" aria-hidden="true"></div>
          <div id="completionFlag" class="completion-flag" aria-hidden="true">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M4 21V3" stroke="#0f172a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M4 7c2-1.5 4-2 6 0s4 0 6-2v10c-2 2-4 1.5-6 0s-4 0-6 2" stroke="#2b8ae2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>Â¡Felicitaciones! Completaste la carrera</span>
          </div>
          <div id="confetti" class="confetti" aria-hidden="true"></div>
        </div>

        <div class="progress-card">
          <div class="progress-bar-outer">
            <div class="progress-bar-inner" id="progressBar"></div>
          </div>
          <div class="progress-info">
            <strong id="percentage">0%</strong>
            <span id="points">0 / 0 puntos</span>
          </div>
          <div id="loadStatus" class="load-status" aria-live="polite" style="margin-top:8px;color:var(--muted);font-size:13px"></div>
        </div>
      </section>

      <section class="controls">
        <div class="career-selector-wrapper">
          <label for="careerSelector">Selecciona tu carrera:</label>
          <select id="careerSelector" class="career-selector">
            <option value="">-- Elige una carrera --</option>
            <option value="materias_TecAnaSistemas151.json">Tecnicatura Analista de Sistemas - ISFT 151</option>
            <option value="materias_TecSupDesaSoftIDRA.json">Tecnicatura Superior en Desarrollo de Software - IDRA</option>
          </select>
          <div class="career-actions">
            <button id="createCareerBtn" class="btn-secondary" title="Crear carrera personalizada">+ Nueva Carrera</button>
            <button id="editCareerBtn" class="btn-secondary" title="Editar carrera actual" style="display:none">âœï¸ Editar</button>
            <button id="duplicateCareerBtn" class="btn-secondary" title="Duplicar carrera actual" style="display:none">ğŸ“‹ Duplicar</button>
            <button id="deleteCareerBtn" class="btn-danger" title="Eliminar carrera personalizada" style="display:none">ğŸ—‘ï¸ Eliminar</button>
          </div>
        </div>
        <h2>Materias <button id="helpBtn" class="help-btn" aria-haspopup="dialog" aria-controls="helpModal" title="Ayuda">?</button></h2>
        <div id="yearTabs" class="year-tabs" role="tablist" aria-label="AÃ±os"></div>
        <div id="subjectsContainer">
          <!-- Materias del aÃ±o seleccionado inyectadas por JS -->
        </div>

        <div class="buttons">
          <button id="exportImageBtn" class="btn-image" title="Descargar imagen del progreso">ğŸ“· Exportar Imagen</button>
          <button id="exportBtn">Exportar JSON</button>
          <input type="file" id="importFile" accept="application/json" style="display:none">
          <button id="importBtn">Importar JSON</button>
        </div>
      </section>
    </main>

    <!-- Help modal -->
    <div id="helpOverlay" class="help-overlay" hidden></div>
    <div id="helpModal" class="help-modal" role="dialog" aria-modal="true" aria-labelledby="helpTitle" hidden>
      <div class="help-content">
        <h3 id="helpTitle">InformaciÃ³n</h3>
        <ul>
          <li>Usa <strong>Importar JSON</strong> para cambiar los datos</li>
          <li>Usa <strong>Exportar JSON</strong> para guardar el estado</li>
          <li>El porcentaje se calcula en relaciÃ³n a la cantidad de horas de cada materia en relaciÃ³n con la cantidad total de horas de la carrera.</li>
          <li><strong>No cursada</strong> 0%</li>
          <li><strong>Cursando</strong> 25%</li>
          <li><strong>Cursada Aprobada</strong> 75%</li>
          <li><strong>Final Aprobado</strong> y <strong>Equivalencia</strong> 100%</li>
        </ul>
        <div class="help-actions"><button id="closeHelp" class="button">Cerrar</button></div>
      </div>
    </div>

    <!-- Career Editor Modal -->
    <div id="careerEditorOverlay" class="help-overlay" hidden></div>
    <div id="careerEditorModal" class="career-editor-modal" role="dialog" aria-modal="true" aria-labelledby="careerEditorTitle" hidden>
      <div class="career-editor-content">
        <div class="modal-header">
          <h3 id="careerEditorTitle">Crear/Editar Carrera Personalizada</h3>
          <button id="careerHelpBtn" class="help-btn" type="button" title="Ayuda">?</button>
        </div>
        
        <div id="careerHelpText" class="career-help-text" hidden>
          <div class="help-box">
            <h4>ğŸ“š CÃ³mo usar esta herramienta:</h4>
            <ul>
              <li><strong>Nombre de la carrera:</strong> Ingresa el nombre completo de tu carrera.</li>
              <li><strong>Agregar materias:</strong> Haz clic en "+ Agregar Materia" para cada materia de tu plan de estudios.</li>
              <li><strong>Nombre:</strong> Escribe el nombre completo de la materia.</li>
              <li><strong>AÃ±o:</strong> Indica a quÃ© aÃ±o corresponde (1, 2, 3, etc.).</li>
              <li><strong>Horas:</strong> Ingresa la carga horaria total de la materia.</li>
              <li><strong>Eliminar:</strong> Usa el botÃ³n ğŸ—‘ï¸ para quitar una materia.</li>
              <li><strong>Guardar:</strong> Cuando termines, haz clic en "Guardar Carrera".</li>
            </ul>
            <p class="help-note">ğŸ’¡ <strong>Consejo:</strong> Puedes duplicar una carrera existente como plantilla y modificarla segÃºn tus necesidades.</p>
          </div>
        </div>
        
        <div class="form-group">
          <label for="careerNameInput">Nombre de la carrera: <span class="required">*</span></label>
          <input type="text" id="careerNameInput" class="form-input" placeholder="Ej: Licenciatura en Sistemas de InformaciÃ³n" required />
        </div>

        <div class="subjects-editor">
          <div class="subjects-header">
            <h4>Materias</h4>
            <button id="addSubjectBtn" class="btn-add" type="button">+ Agregar Materia</button>
          </div>
          
          <div id="subjectsEditorList" class="subjects-editor-list">
            <!-- Las materias se agregan dinÃ¡micamente aquÃ­ -->
          </div>
        </div>

        <div class="career-editor-actions">
          <button id="saveCareerBtn" class="btn-primary">Guardar Carrera</button>
          <button id="cancelCareerBtn" class="btn-secondary">Cancelar</button>
        </div>
      </div>
    </div>

    <footer>
      <small>Demo local â€” datos guardados en localStorage</small>
      <div class="credits">
        DiseÃ±ado por <a href="https://github.com/carlosguariglia" target="_blank" rel="noopener">Carlos Guariglia</a>
      </div>
    </footer>
  </div>
  <script src="app.js"></script>
</body>
</html>